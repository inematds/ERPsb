# Story 4.3: Integracao PIX - Mercado Pago (Cobranca e QR Code)

## Status: Draft

## Story

**As a** usuario,
**I want** gerar cobranca PIX em 1 clique com QR code,
**so that** meu cliente possa pagar instantaneamente pelo celular.

## Acceptance Criteria

1. Integracao com API Mercado Pago configurada (credenciais em env vars)
2. Model PixCharge no Prisma: id, tenantId, contaReceberId (FK), externalId, amount, qrCode (base64), qrCodeText, paymentLink, status (PENDING/PAID/EXPIRED/CANCELLED), expiresAt, paidAt, createdAt
3. Botao "Cobrar via PIX" disponivel em conta a receber e tela de venda
4. Ao clicar: chama API Mercado Pago, gera cobranca PIX, exibe QR code
5. Tela de cobranca PIX com: QR code, botao "Copiar codigo PIX", botao "Compartilhar"
6. Cobranca com expiracao configuravel (default: 24h)
7. Status da cobranca atualizado na tela

## Tasks / Subtasks

- [ ] Adicionar model PixCharge ao Prisma schema (AC: 2)
- [ ] Criar Mercado Pago client (AC: 1)
- [ ] Criar service PIX (AC: 3, 4, 6)
- [ ] Criar API routes PIX (AC: 3, 4)
- [ ] Criar tela de cobranca PIX (AC: 5, 7)
- [ ] Integrar PIX nos fluxos existentes (AC: 3)

## Dev Notes

**Depende de:** Story 3.2 (ContaReceber), Story 4.1 (Vendas)
**Integracao externa:** Mercado Pago API - requer MERCADO_PAGO_ACCESS_TOKEN em env vars

### Testing

- **Testes:** Mock da API Mercado Pago, criacao de cobranca, verificacao de status

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-07 | 1.0 | Criacao inicial da story | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
*A ser preenchido*

### Debug Log References
*A ser preenchido*

### Completion Notes List
*A ser preenchido*

### File List
*A ser preenchido*

## QA Results
*A ser preenchido pelo QA agent*
