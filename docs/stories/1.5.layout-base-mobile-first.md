# Story 1.5: Layout Base e Navegacao Mobile-First

## Status: Draft

## Story

**As a** usuario,
**I want** uma interface clara com navegacao facil pelo celular,
**so that** eu consiga acessar todas as funcoes sem me perder.

## Acceptance Criteria

1. Layout base com bottom navigation (5 tabs): Home, Financeiro, Vender, Fiscal, Menu
2. Header com nome da empresa ativa, sino de notificacoes e avatar do usuario
3. FAB (Floating Action Button) "+" para acoes rapidas: Nova Venda, Nova Cobranca, Nova Despesa
4. Dashboard Home vazio com placeholders e CTAs para primeiras acoes ("Cadastre seu primeiro cliente", "Faca sua primeira venda")
5. Tela de Configuracoes acessivel via Menu com dados da empresa, perfil do usuario e opcao de alternar empresa
6. Responsivo: layout adapta de mobile (bottom nav) para desktop (sidebar nav) em breakpoint 1024px
7. Tema com cores do semaforo integrado ao Tailwind config
8. Loading states (skeleton) e empty states para todas as telas principais

## Tasks / Subtasks

- [ ] Criar layout principal do dashboard (AC: 1, 6)
  - [ ] Criar `src/app/(dashboard)/layout.tsx` como Server Component
  - [ ] Layout inclui: Header (topo), conteudo principal (meio), BottomNav (rodape)
  - [ ] No desktop (>= 1024px): esconder BottomNav e mostrar Sidebar lateral
  - [ ] Usar CSS Grid ou Flexbox para estrutura responsiva
  - [ ] Safe area padding para mobile (notch, barra de navegacao)
- [ ] Implementar Bottom Navigation (AC: 1)
  - [ ] Criar `src/components/layout/bottom-nav.tsx` como Client Component
  - [ ] 5 tabs com icones (Lucide): Home (Home), Financeiro (Wallet), Vender (ShoppingCart), Fiscal (FileText), Menu (Menu)
  - [ ] Tab ativa com destaque visual (cor primaria, icone preenchido)
  - [ ] Links para: `/`, `/financeiro`, `/vendas/nova`, `/fiscal`, `/configuracoes`
  - [ ] Fixed no rodape, z-index adequado, altura ~64px
  - [ ] Esconder em telas >= 1024px via `lg:hidden`
- [ ] Implementar Sidebar para desktop (AC: 6)
  - [ ] Criar `src/components/layout/sidebar.tsx` como Client Component
  - [ ] Sidebar fixa a esquerda com logo, links de navegacao e user info
  - [ ] Mesmos links do BottomNav + subitens expandiveis
  - [ ] Mostrar apenas em telas >= 1024px via `hidden lg:flex`
  - [ ] Largura: 240px, colapsavel para 64px (apenas icones)
- [ ] Implementar Header (AC: 2)
  - [ ] Criar `src/components/layout/header.tsx` como Client Component
  - [ ] Lado esquerdo: nome da empresa ativa (do tenant context)
  - [ ] Lado direito: sino de notificacoes (badge com count), avatar do usuario
  - [ ] Clicar no nome da empresa: abre selector de empresas (se usuario tem multiplas)
  - [ ] Clicar no avatar: abre dropdown com "Configuracoes" e "Sair"
  - [ ] Clicar no sino: navega para `/notificacoes`
  - [ ] Sticky no topo, z-index adequado, altura ~56px
- [ ] Implementar FAB (Floating Action Button) (AC: 3)
  - [ ] Criar `src/components/layout/fab.tsx` como Client Component
  - [ ] Botao circular "+" fixo no canto inferior direito (acima do BottomNav)
  - [ ] Ao clicar: expande menu com 3 opcoes (animacao radial ou sheet)
    - [ ] "Nova Venda" -> navega para `/vendas/nova`
    - [ ] "Nova Cobranca" -> navega para `/financeiro/contas-receber?new=true`
    - [ ] "Nova Despesa" -> navega para `/financeiro/contas-pagar?new=true`
  - [ ] Cada opcao com icone + label
  - [ ] Backdrop overlay quando expandido
  - [ ] Esconder FAB em desktop (acoes acessiveis pela sidebar)
- [ ] Criar Dashboard Home com empty states (AC: 4, 8)
  - [ ] Criar `src/app/(dashboard)/page.tsx` como Server Component
  - [ ] Verificar se tenant tem dados: clientes, vendas, contas
  - [ ] Se vazio: mostrar empty state com CTAs contextuais
    - [ ] Card "Cadastre seu primeiro cliente" -> link para `/cadastros/clientes`
    - [ ] Card "Faca sua primeira venda" -> link para `/vendas/nova`
    - [ ] Card "Registre uma conta a pagar" -> link para `/financeiro/contas-pagar`
  - [ ] Se tem dados: mostrar placeholders para componentes do semaforo (a serem implementados em Epic 3)
  - [ ] Mensagem de boas-vindas para usuario recem-onboarded
- [ ] Criar componentes de empty state e loading skeleton (AC: 8)
  - [ ] Criar `src/components/shared/empty-state.tsx` - componente reutilizavel
    - [ ] Props: icon, title, description, actionLabel, actionHref
    - [ ] Layout centrado com ilustracao/icone e CTA
  - [ ] Criar `src/components/shared/loading-skeleton.tsx` - componente reutilizavel
    - [ ] Skeleton para listas (linhas pulsantes)
    - [ ] Skeleton para cards (retangulos pulsantes)
    - [ ] Skeleton para dashboard (combinacao de cards e graficos)
  - [ ] Usar componentes `Skeleton` do shadcn/ui como base
- [ ] Criar tela de Configuracoes (AC: 5)
  - [ ] Criar `src/app/(dashboard)/configuracoes/page.tsx`
  - [ ] Secao "Minha Empresa": nome, tipo, documento, endereco (editavel)
  - [ ] Secao "Meu Perfil": nome, email, imagem (read-only do Google OAuth)
  - [ ] Secao "Alternar Empresa": lista de tenants do usuario, botao para switch
  - [ ] Secao "Sobre": versao do app, link para suporte
  - [ ] Botao "Sair" com confirmacao
- [ ] Configurar tema semaforo no Tailwind (AC: 7)
  - [ ] Atualizar `tailwind.config.ts` com cores do semaforo:
    - [ ] `semaforo-green`: green-500 (#22c55e) - saude boa
    - [ ] `semaforo-yellow`: yellow-500 (#eab308) - atencao
    - [ ] `semaforo-red`: red-500 (#ef4444) - critico
  - [ ] Configurar cores primarias do shadcn/ui theme
  - [ ] Dark mode preparado (nao ativado neste MVP, mas CSS variables prontas)
- [ ] Criar tela de Notificacoes (AC: 2)
  - [ ] Criar `src/app/(dashboard)/notificacoes/page.tsx`
  - [ ] Lista de notificacoes com empty state inicial
  - [ ] Criar `src/stores/notification-store.ts` com Zustand para gerenciar badge count
  - [ ] Placeholder para notificacoes futuras (PIX recebido, alerta financeiro, etc)

## Dev Notes

**Source Tree relevante:**
```
src/
├── app/(dashboard)/
│   ├── layout.tsx              # Layout principal (Header + BottomNav/Sidebar + content)
│   ├── page.tsx                # Dashboard Home (empty state ou semaforo)
│   ├── configuracoes/page.tsx  # Tela de configuracoes
│   └── notificacoes/page.tsx   # Tela de notificacoes
├── components/
│   ├── layout/
│   │   ├── bottom-nav.tsx      # Bottom navigation (mobile)
│   │   ├── header.tsx          # Header com empresa + notificacoes + avatar
│   │   ├── sidebar.tsx         # Sidebar (desktop)
│   │   └── fab.tsx             # Floating Action Button
│   └── shared/
│       ├── empty-state.tsx     # Componente reutilizavel de empty state
│       └── loading-skeleton.tsx # Componente reutilizavel de skeleton
├── stores/
│   └── notification-store.ts   # Zustand store para notificacoes
└── hooks/
    └── use-tenant.ts           # Hook de tenant (de Story 1.3)
```

**Depende de:** Story 1.2 (auth, sessao), Story 1.3 (tenant context, useTenant hook), Story 1.4 (onboarding completo)

**Breakpoints responsivos:**
- Mobile: < 640px (sm) - bottom nav, FAB, layout mobile
- Tablet: 640px - 1023px - bottom nav, layout adaptado
- Desktop: >= 1024px (lg) - sidebar, sem bottom nav, sem FAB

**Componentes shadcn/ui utilizados:**
- Button, Avatar, Badge, DropdownMenu, Sheet (para FAB menu)
- Skeleton (para loading states)
- Card (para empty states e dashboard)
- Separator (para secoes de configuracoes)

**Coding Standards:**
- Layout como Server Component; BottomNav, Header, Sidebar, FAB como Client Components (`'use client'`)
- Icones via `lucide-react` (tree-shakeable)
- Navegacao via `next/link` (prefetching automatico)
- Safe area insets via `env(safe-area-inset-bottom)` para mobile
- Skeleton loading com Suspense boundaries no layout
- Zustand store para notification count (client-side only)

### Testing

- **Localizacao:** `tests/unit/components/layout/`
- **Framework:** Vitest + Testing Library
- **Testes necessarios:**
  - BottomNav renderiza 5 tabs com links corretos
  - BottomNav destaca tab ativa com base na rota
  - Header exibe nome da empresa do tenant ativo
  - Header exibe badge de notificacoes quando count > 0
  - FAB expande/colapsa ao clicar
  - Empty state renderiza corretamente com props
  - Loading skeleton renderiza para diferentes tipos (list, card, dashboard)
  - Configuracoes exibe dados da empresa e perfil do usuario
  - Zustand notification store incrementa/reseta count
- **E2E (futuro):** Navegacao completa entre telas via Playwright

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-07 | 1.0 | Criacao inicial da story | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
*A ser preenchido pelo dev agent*

### Debug Log References
*A ser preenchido pelo dev agent*

### Completion Notes List
*A ser preenchido pelo dev agent*

### File List
*A ser preenchido pelo dev agent*

## QA Results
*A ser preenchido pelo QA agent*
