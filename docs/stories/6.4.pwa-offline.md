# Story 6.4: PWA Completo e Offline Basico

## Status: Draft

## Story

**As a** usuario,
**I want** instalar o ERPsb no meu celular como se fosse um app,
**so that** eu acesse rapidamente e possa consultar dados mesmo sem internet.

## Acceptance Criteria

1. manifest.json configurado: nome, icones (512px, 192px, maskable), theme_color, background_color, display: standalone, start_url
2. Service worker com estrategias de cache: cache-first para assets, stale-while-revalidate para dados API, network-first para operacoes criticas
3. Banner de instalacao nativo (beforeinstallprompt) com CTA customizado
4. Offline basico: consultar cadastros e ver ultimo saldo do dashboard
5. Indicador visual quando offline: banner no topo
6. Splash screen com logo ao abrir PWA instalado

## Tasks / Subtasks

- [ ] Configurar manifest.json (AC: 1)
  - [ ] Criar icones PWA (192px, 512px, maskable)
  - [ ] Configurar manifest com tema e cores do ERPsb
- [ ] Configurar service worker via next-pwa/serwist (AC: 2)
  - [ ] Instalar e configurar next-pwa ou serwist
  - [ ] Estrategias de cache por rota
- [ ] Criar hook usePwaInstall (AC: 3)
  - [ ] Capturar beforeinstallprompt
  - [ ] Componente de banner de instalacao
- [ ] Implementar indicador offline (AC: 5)
  - [ ] Hook useOnlineStatus
  - [ ] Banner no layout quando offline
- [ ] Escrever testes
  - [ ] Testes do hook usePwaInstall
  - [ ] Testes do hook useOnlineStatus

## Dev Notes

**Depende de:** Layout basico (Epic 1)
**MVP simplification:** Offline basico = cache de assets + ultima resposta de API. Sem sync offline complexo.

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2026-02-07 | 1.0 | Criacao inicial da story | Sarah (PO) |

## Dev Agent Record

### Agent Model Used
Claude Opus 4.6 (claude-opus-4-6)

### Debug Log References
*To be filled during development*

### Completion Notes List
*To be filled during development*

### File List
*To be filled during development*

## QA Results
*A ser preenchido pelo QA agent*
